<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      var MSG_EQUIPAMENTO1 = "Escolha o número do seu 1º equipamento:\n";
      var MSG_EQUIPAMENTO2 = "Agora, o número do seu 2º equipamento:\n";

      var equipments = [
        { id: 1, nome: "Espada" },
        { id: 2, nome: "Arco e Flecha" },
        { id: 3, nome: "Armadura" },
        { id: 4, nome: "Lança" },
      ];

      function montarFrase(fraseInicial, equipamentos) {
        var frase = fraseInicial;
        for (var indice = 0; indice < equipamentos.length; indice += 1) {
          frase = frase.concat(
            equipamentos[indice].id + "- " + equipamentos[indice].nome + "\n"
          );
        }
        return frase;
      }

      var player = {
        nome: "",
        equipamentos: [],
        item: "",
      };

      function escolherArmas(equipamentosPlayer) {
        var equipamentosPlayer = [];

        while (equipamentosPlayer.length == 0) {
          var escolha = window.prompt(
            montarFrase(MSG_EQUIPAMENTO1, equipments)
          );

          var ehEquipamentoValido = equipments.some(function (equipamento) {
            return equipamento.id == escolha;
          });

          if (ehEquipamentoValido) {
            var equipEscolhido = equipments.find(function (equip) {
              return escolha == equip.id;
            });
            equipamentosPlayer.push(equipEscolhido);
          }
        }

        while (equipamentosPlayer.length == 1) {
          var escolha2 = window.prompt(
            montarFrase(MSG_EQUIPAMENTO2, equipments)
          );

          var ehEquipamentoValido2 = equipments.some(function (equipamento) {
            return equipamento.id == escolha2;
          });

          if (ehEquipamentoValido2) {
            var jaPossui = equipamentosPlayer.some(function (equipamento) {
              return equipamento.id == escolha2;
            });

            if (jaPossui) {
              window.alert(
                "Equipamentos inválidos. Por favor, escolha novamente."
              );
              equipamentosPlayer = [];
            } else {
              var equipEscolhido2 = equipments.find(function (equip) {
                return escolha2 == equip.id;
              });
              equipamentosPlayer.push(equipEscolhido2);
            }
          }
        }
        return equipamentosPlayer;
      }

      while (player.nome == "") {
        player.nome = window.prompt("Escolha seu nome:");
      }

      while (player.equipamentos.length < 2) {
        player.equipamentos = escolherArmas();
      }

      console.log(player);
    </script>
  </body>
</html>
